### 【基于深度学习的服装搭配推荐算法研究与实现】
#### 【一】、论文基本信息
* 论文发布时间
* 发布位置
* 论文作者
#### 【二】、论文内容
##### 一、摘要
* 【研究问题】：上下衣服装搭配推荐问题；
* 【研究基础】：协同过滤算法、卷积神经网络、迁移学习、GBTree算法；
* 【研究成果】：提出了服装搭配混合推荐算法，其算法较单独的推荐算法更优；
* 【研究思路】
1. 从服装图像数据、服装文本描述数据、用户购买行为数据、专家推荐搭配数据入手，研究上下衣服装搭配推荐问题；
2. 针对专家给的服装搭配信息：借鉴协同过滤思想提出服装搭配协同推荐算法；
3. 针对服装文本描述数据：构建向量空间模型表示服装，计算相似度进行服装搭配预测；
4. 针对用户购买行为数据：关联规则挖掘服装搭配模式；
5. 针对服装搭配需要的算法：详见【创新亮点】；
* 【创新亮点】  

|*研究基础*|*创新内容*|*备注* |
|:--|:--|:--|
|协同过滤算法|**服装搭配协同推荐算法**|具体内容见论文|
|服装文本描述数据|**构建了向量空间模型来表示**|构建模型后通过计算相似度进行服装搭配预测|
|卷积神经网络|**提出了TCNN-GBT模型**|通过CNN将服装问题转换为二分类问题|
|ImageNet的CNN网络|**调整参数、加入GBTree算法进行监督学习**|具体内容见论文|
|GBTree算法|**提出新型的目标函数**|具体内容见论文|

* 【关键词】：推荐系统、服装搭配、深度卷积神经网络、迁移学习、协同过滤；

##### 二、绪论
* 研究背景&目的
1. 在线购物发展迅速，购物相关的数据量呈指数式增长；
2. 商品数量越来越多，信息过载比较严重，并且用户对个性化的商品推荐要求越来越高；
3. 推荐系统能够有效解决信息过载的情况，推荐系统能够有效满足用户的个性化需求；
4. 服装不但是网上购物极其重要一类，而且具有很强的搭配组合模式，故需要有相关推荐算法研究；
5. 服装推荐的研究有各大电商平台的数据作支撑，而且研究结果可以被合理应用；
6. 服装推荐不仅可以从用户购买行为，而且可以从服装描述、服装图像等角度挖掘服装搭配模型；

* 国内外状况
1. Recsy会议：专业的以推荐系统为专题的会议；
2. 基于内容的推荐方式：依赖用户画像、商品描述；
3. 协同过滤推荐：user-based、item-based，分别寻找目标用户/目标商品的近邻，依赖于用户、商品、用户行为；
* 研究内容&研究方法
1. 针对已有推荐算法进行研究：提出服装搭配协同推荐算法；
2. 针对服装内容的搭配推荐进行研究：提出基于服装内容进行搭配推荐的方法；
3. 针对服装销售历史数据进行分析，通过关联规则挖掘服装搭配模式；
4. 针对深度学习进行研究：建立服装搭配模型；
5. 针对梯度提升树GBTree进行研究：对GBTree进行改进；
6. 针对迁移学习进行研究：使用基于ImageNet的CNN模型，构建服装搭配模型，并使用GBTree算法对模型进行优化；
7. 针对算法融合问题的研究：将文章提到的多种算法进行融合；
 
##### 三、相关技术
* 推荐系统介绍
详见XXX
* 深度学习介绍
详见XXX
* 集成学习介绍
详见XXX
##### 四、服装搭配推荐算法研究
* 问题分析
1. 人们愈来愈注意个人形象，愈来愈重视服装搭配，但却缺少服装搭配的知识和技巧；
2. 服装推荐系统一方面可以解决用户专业化搭配的需求，一方面可以服务在线销售领域；
3. 研究的基础：服装搭配数据，在各大电商平台都已经得到了长足的积累；  

###### （一）服装搭配协同推荐算法
* 研究思路
1. 针对服装文本描述、服装图像数据、用户购买数据、专业性服装搭配组合数据等数据信息，进行构建服装搭配推荐模型； 
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020071419332792.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
2. 针对服装图像数据，基于如今神经网络特别是CNN取得的良好的图像处理技术，通过深度学习技术对服装图像进行处理；
3. 【构建服装搭配推荐模型】非监督学习方式：通过关联规则挖掘上下衣服装的内容描述相关程度；
4. 【构建服装搭配推荐模型】监督学习方式：通过专家给出的服装搭配组合套餐数据构建监督学习模型；该模型为分类模型；

```mermaid
flowchat
st=>start: 开始
e=>end: 结束
op=>operation: 我的操作
op1=>operation: 建立二分类模型
op2=>operation: 将专家给出的服装搭配组合作为正样本
op3=>operation: 尽可能地选择搭配较弱的服装组合作为负样本；
op4=>operation: 基于构造的正负样本数据进行监督学习训练
op5=>operation: 完成服装搭配模型
op6=>operation: 对任意上下衣服装进行预测

st->op1->op2->op3->op4->op5->op6->e
```

* 算法说明
1. 服装搭配协同推荐算法：基于用户和商品之间的二元关系（搭配关系），示意图如下：
![](https://img-blog.csdnimg.cn/20200714201658307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
【说明】  

|上衣服装|搭配下衣服装|相似推测|
|--|--|--|
|uc1|lc1、lc2、lc3|uc1和uc2有相同的下衣搭配，存在一定的相似性|
|uc2|lc1、lc2|uc1和uc2有相同的下衣搭配，存在一定的相似性|
推测||uc1和lc3是搭配的，故uc2和lc3可能是搭配的|

* 算法设计
1. 【核心思路】：如果两个上衣服装的搭配下衣服装集合相似度较高，则两个上衣服装间的相似度较高；
2. 【相似度】：Jaccard集合相似度度量方法，通过计算集合的交集相对大小来衡量集合的相似度。具体公式如下：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200714204604520.png)
3. 【通过服装数据计算相似度】：
假设uc1的搭配组合集合uc1-MachSet为{lc1,lc2,lc3},上衣服装uc2的搭配组合集合uc2-MachSet为{lc1,lc2,lc4}，那么上衣服装uc1和上衣服装uc2，uc3的相似度可通过如下方式计算：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200714205336735.png)
4. 【通过服装数据计算搭配度】：
仅仅通过上衣服装的相似度过于简单，缺乏服装的针对性，故参考TF-IDF的思想，对上衣服装搭配集合中的服装进行个性化度量；
首先通过给定的专家搭配，以上衣服装进行分组，统计每个上衣服装搭配的下衣服装集合；
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715100835229.png)
再通过余弦相似度进行计算；
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715100859256.png)
5. 【多条搭配路径】：选取相似度最大的作为候选项与目标服装搭配，如下图所示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715084510894.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)6.【具体算法实现】
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020071510180238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
算法流程如下：
```mermaid
flowchat
st=>start: 开始
e=>end: 结束
cond1=>condition: 当前上衣被遍历结束
cond2=>condition: 其他上衣被遍历结束
op=>operation: 计算各上下衣服装的搭配度
op0=>operation: 通过余弦相似度来寻找近邻  
op1=>operation: 求当前上衣与其他上衣的交集
op2=>operation: 求当前上衣与其他上衣的并集
op3=>operation: 通过Jaccard公式计算上衣间相似度
op4=>operation: DataFrame形式保存上衣和对应相似度
op5=>operation: 按相似度高低依次获取目标上衣的相似上衣的搭配下装集合
op6=>operation: 返回上衣和推荐下衣服装搭配集合
cond=>condition: 确认？

st->cond1
cond1(yes)->op5
cond1(no)->op->cond2
op1->op2->op3
op3(right)->cond2
op4(right)->cond1
op5->op6->e
cond2(yes)->op4
cond2(no)->op1
```

###### （二）基于矩阵分解的服装搭配推荐算法
* 研究思路
1. 将上衣服装和下衣服装视为一种二元关系，并通过矩阵分解的方法将二元搭配矩阵分解为两个独立的矩阵；
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715104349687.png)
2. 将矩阵分解问题转换为最优解问题：
3. 定义损失函数：*设置正则项减少过拟合风险*
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715104720812.png)
4. 优化器选择：
使用梯度下降算法
6. 学习率设置：
* 算法说明
* 略

###### （三）基于内容的服装搭配推荐算法
【思路一】关注服装的内在属性信息：服装标题、图片，通过内容相关性挖掘服装搭配模式。
* 通过上衣服装近邻寻找搭配路径
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715133010873.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
* 通过上下衣服装近邻寻找搭配路径：
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020071513302743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
 【思路二】关注服装的文本内容：标题内容
 * 建立空间向量模型：将普通的文本内容转化为便于进行数学运算的向量形式；
 * 对文本内容中的词重要性进行刻画：TF-IDF；
 * 通过计算上衣服装与下衣服装的标题相似度来进行服装搭配预测；
 * 通过寻找已知专家搭配的标题相似度近邻来进行服装搭配预测；
###### （四）基于关联规则的服装搭配推荐算法
【思路】挖掘用户的交易历史记录，挖掘购买上衣服装与下衣服装的频繁模式；
* 对历史交易数据进行过滤，保留响应的上衣服装类目与下衣服装类目；
* 针对每个人将其购买的上衣服装与下衣服装两两组合，记录购买上下衣服装相差的时间间隔天数；
* 基于上衣付账与下衣服装的组合以及购买间隔天数进行分组，统计出现这种模式的频繁次数；
* 挖掘上衣服装、下衣服装、间隔天数的模式支持度，具体流程见下图：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200715203009529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
###### （五）试验与分析
* 实验数据：阿里天池的公开数据集Taobao_Clothes_Mathch
* 实验测评方法：使用平均准确度MAP进行越策结果和专家给出的搭配组合的匹配度；
* 实验结果：服装搭配协同推荐，包含三种算法：
1. 【实验一】基于Jaccard的服装搭配协同推荐算法
2. 【实验二】基于搭配度的服装搭配协同推荐算法
3. 【实验三】基于Jaccard的服装搭配推荐算法
##### 五、基于深度学习的服装搭配推荐算法研究
###### （一）基于深度学习的服装图像特征挖掘方法研究
* 【研究思路】
在符篆搭配研究中，服装图像包含了服装的风格、款式等，利用深度学习能够对服装进行较好的认知，可以基于卷积神经网络模型挖掘服装图像特征

* 【使用成熟的卷积神经网络】：使用AlexNet作为提取服装图像特征的卷积神经网络模型；
* 【特征学习】：使用深度学习学习服装图像的特征，且具有一定的泛化能力；
###### （二）基于服装图像特征的搭配算法研究 
* 【研究思路】 
使用AlexNet可以将服装图像转换为一维特征向量，从使用基于近邻的服装搭配算法

* 【使用服装图像近邻的搭配推荐】：使用近邻计算对图像特征的相似度进行计算
举例说明：如果上衣服装uc1余下衣服装lc1搭配，并且通过根据图像特征进行近邻计算发现下衣服装lc2和lc1最相似，那么下衣服装lc2很有可能与上衣服装uc1是搭配服装组合
* 【提出CNN-GBT模型】：将上衣图像和下衣图像组合后通过卷积神经网络来学习；
1. 将搭配组合的图像转化为一维特征图像；
2. 结合集成学习算法对服装搭配进行监督学习
3. 基于通过深度卷神经网络抽取去得到的服装图像一维特征向量
4. 在通过近邻寻找搭配组合
5. 模型结构如下所示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200716201738621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
6. 模型说明：前七层采用CNN模型，后面连接梯度提升树算法（GBTree）进行监督学习
7. 训练过程： 
***步骤一：基于AlexNet在ImageNet数据集上训练得到CNN模型，并取前7层网络参数不变***
***步骤二：确定神经网络模型后，加入GBTree算法记性服装搭配图像的监督训练***
8. 训练结果：获取服装搭配混合推荐算法的训练数据和测试数据
建模的目的为实现对服装搭配的“二分类”，即将上下衣服装搭配问题转化为普通二分类问题；
如果是专家给出的搭配组合则为正样本；
如果不是专家给出的搭配组合则为负样本；
9. 存在问题&解决方式
问题一：将服装搭配问题转化为二分类问题，需要面临实际情况：考虑到专家标注的搭配组合时，不一定会基于全量的服装去选择搭配，所有有些不是专家给出的搭配可能也是搭配组合。
解决办法 ：在构造负样本的时候进行筛选，基于已知的专家搭配来构造负样本，选择与一直专家搭配服装图像相似度较小的服装作为负样本。

> 举例说明：上衣服装uc1和下衣服装lc1是专家给出的搭配，同时机油训练好好的深度卷积神经网络模型可以抽取服装图像特征；可以通过图像特征相似度计算下衣服装中所有衣服与下衣服装lc1的相似度距离，如果相似度较低，那么其与上衣服装uc1搭配的可能性也低；

* 【对GBTree算法的研究和改进】
1. 训练思路：提出新的目标函数
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200716205627215.png)
2. 改进后的算法的效果
文章采用的损失函数作为梯度提升树的目标函数较平方损失函数、逻辑损失函数作为目标效果更好，在[0,1]区间函数更陡峭，函数下降速度更快，下降速度快的目标函数更容易达到最优值，在保证准确度的条件下，训练时间可以大幅缩小。其在y=1的情况下，损失函数变化曲线如下图所示：
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200716205654658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1BldGVyVmVn,size_16,color_FFFFFF,t_70)
###### （三）基于迁移学习的搭配算法研究
##### 六、服装搭配混合推荐算法研究
